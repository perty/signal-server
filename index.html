<html lang="en">
<head>
    <title>Socket.io example</title>
    <script src="https://cdn.socket.io/4.2.0/socket.io.min.js"
            integrity="sha384-PiBR5S00EtOj2Lto9Uu81cmoyZqR57XcOna1oAuVuIEjzj0wpqDVfD0JA9eXlRsj"
            crossorigin="anonymous"></script>
    <script>
        let socket = io();

        socket.on('connect', () => {
            document.getElementById('connect-id').innerHTML = 'Connected with id: ' + socket.id;
            document.getElementById('connect-button').setAttribute('value', 'Disconnect');
        });

        socket.on('disconnect', () => {
            document.getElementById('connect-id').innerHTML = 'Not connected';
            document.getElementById('connect-button').setAttribute('value', 'Connect');
        });

        socket.on('signal', (data) => {
            console.log('signal', data);
            appendData(data);
        });

        socket.on('time', (timeString) => {
            document.getElementById('server-time').innerHTML = 'Server time: ' + timeString;
        });

        const toggleConnection = () => {
            if (socket.connected) {
                document.getElementById('connect-id').innerHTML = 'Disconnecting';
                document.getElementById('send-button').disabled = true;
                socket.disconnect();
            } else {
                document.getElementById('connect-id').innerHTML = 'Connecting';
                document.getElementById('send-button').disabled = false;
                socket.connect();
            }
        }

        const sendSignal = () => {
            const field = document.getElementById('input-field');
            socket.emit('signal', field.value);
            appendData(field.value);
            field.value = "";
        }

        const appendData = (data) => {
            const p = document.createElement("P");
            const t = document.createTextNode(data);
            p.appendChild(t);
            document.getElementById('signal-list')
                .appendChild(p);
        }
    </script>
</head>
<body>
<p id="server-time"></p>
<p id="connect-id">Not connected</p>
<input id="connect-button" type="button" value="XX" onclick="toggleConnection()"/>
<div id="signal-list">

</div>
<div>
    <label>
        <input id="input-field" type="text"/>
    </label>
    <input id="send-button" type="button" value="Send" onclick="sendSignal()"/>
</div>
</body>
</html>